

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Compass &mdash; microbit_tutorials 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="microbit_tutorials 1 documentation" href="../index.html"/>
        <link rel="next" title="The Thermometer" href="thermometer.html"/>
        <link rel="prev" title="The Accelerometer" href="accelerometer.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> microbit_tutorials
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="images.html">LED Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="buttons.html">The Buttons</a></li>
<li class="toctree-l1"><a class="reference internal" href="accelerometer.html">The Accelerometer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Compass</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-functions">Basic Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ideas-for-projects-with-the-compass">Ideas for Projects with the Compass</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="thermometer.html">The Thermometer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">microbit_tutorials</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>The Compass</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/compass.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-microbit.compass">
<span id="the-compass"></span><h1>The Compass<a class="headerlink" href="#module-microbit.compass" title="Permalink to this headline">¶</a></h1>
<p>A magnetometer measures magnetic field strength in each of three axes. It
can be used to create a digital compass or to explore magnetic fields,
such as those generated by a permanent magnet or those around a coil
through which a current is running.</p>
<img alt="../_images/compass.jpg" src="../_images/compass.jpg" />
<p>The interpretation of magnetic
field strength is not easy. The driver for the magnetometer returns
raw values. Each magnetometer is different and will require
calibration to account for offsets in the raw numbers and distortions
to the magnetic field introduced by what are known as hard and soft
iron interference.</p>
<p>Before doing anything else, you should calibrate your BBC micro:bit but beware:</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Calibrating the compass will cause your program to pause until calibration
is complete. Calibration consists of a little game to draw a circle on the
LED display by rotating the device.`</p>
</div>
<div class="section" id="basic-functions">
<h2>Basic Functions<a class="headerlink" href="#basic-functions" title="Permalink to this headline">¶</a></h2>
<p>The interface to the magnetometer looks very much like the interface to the accelerometer, except that we only use the x and y values to determine direction.  Remember, before using the compass you should calibrate it, otherwise the readings may be wrong:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">microbit</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">compass</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">compass</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">compass</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x reading: &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;, y reading: &quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p>This reads the magnetic field in two dimensions (like an actual compass) and outputs the values, which seems easy enough.  The stronger the field, the bigger the number. Try it out and figure out which is the x axis for the magnetometer.
If you want to know the direction you need to calculate <span class="math">\(tan^{-1} (y/x)\)</span>, in python this is written as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">microbit</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">compass</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">compass</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">compass</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">PI</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Direction: &quot;</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p>The 180/PI is because the angle returned is in radians rather than degrees.  Fortunately, the BBC micro:bit has a function to calculate the heading automatically:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">compass</span><span class="o">.</span><span class="n">heading</span><span class="p">()</span>
</pre></div>
</div>
<p>This gives the compass heading, as an integer in the range from 0 to 360, representing the angle in degrees, clockwise, with north as 0.</p>
</div>
<div class="section" id="ideas-for-projects-with-the-compass">
<h2>Ideas for Projects with the Compass<a class="headerlink" href="#ideas-for-projects-with-the-compass" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Make the micro:bit into a compass that illuminates the LED closest to where north lies.</li>
<li>Calibrate your magnetometer. Find out whether the calibration stays (about) the same over time and whether it is the same inside or outside a building or near something that has a lot of steel in it (e.g. a lift).</li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="thermometer.html" class="btn btn-neutral float-right" title="The Thermometer" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="accelerometer.html" class="btn btn-neutral" title="The Accelerometer" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Rae Harbird, Stephen Hailes.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>